<ng-template #hdrTpl let-column="column" >
    <filter-comp [columnName]=column.name>
    </filter-comp>        
</ng-template>

<ng-template #editTmpl let-row="row" let-value="value">
    <div *ngIf="value.length > 0">
        <img 
            width="50"
            src="http://genplan1/img/data/{{value[0].preview}}"
            />
    </div>
</ng-template>                                

<ng-template #clientControlTmpl let-row="row" let-value="value">
    <div class="actions" fxLayout="row" fxLayoutAlign="start center">

        <button *ngIf="value == ''" mat-icon-button matTooltip="Взять заявку" (click)="toggleUserGet(row)" aria-label="Toggle important">
            <mat-icon class="green-fg">attach_money</mat-icon>
        </button>

        <button *ngIf="value != ''" mat-icon-button matTooltip="Отказаться от заявки"  (click)="declineClient(row)" aria-label="Toggle important">
            <mat-icon class="red-fg">close</mat-icon> {{value}}
        </button>

    </div>
</ng-template>                                

<ng-template #clientIdTmpl let-row="row" let-value="value">
    <div class="actions" fxLayout="row" fxLayoutAlign="start center">

        <button mat-icon-button matTooltip="Подробнее" (click)="view_details(value)" aria-label="Toggle star" *ngIf="value > 0">
            {{value}} <mat-icon class="amber-fg">pageview</mat-icon>
        </button>
    </div>
</ng-template>                                

<ng-template #clientStatusIdTmpl let-row="row" let-rowIndex="rowIndex" let-value="value">
    <div class="actions" fxLayout="row" fxLayoutAlign="start center">
<span *ngIf="row.user_id.value == 0">
        <span>
              {{value}}
            </span>
</span>
        
<span *ngIf="row.user_id.value != 0">
        <span 
              title="Двойной щелчок для редактирования"
              (dblclick)="editing[rowIndex + '-status_id'] = true"
              *ngIf="!editing[rowIndex + '-status_id']">
              {{value}}
            </span>
</span>
        

            <select placeholder="Укажите статус заявки"
              *ngIf="editing[rowIndex + '-status_id']"
              (blur)="editing[rowIndex + '-status_id'] = false"
                (change)="updateValue($event, 'status_id', rowIndex, row)"
              [value]="value">
    <option *ngFor="let key of objectKeys(item_model.status_id.select_data)" value="{{key}}">{{item_model.status_id.select_data[key]}}</option>
</select>
</div>
</ng-template>                                

<div id="ngx-datatable" class="page-layout simple fullwidth">
    <!-- CONTENT -->
    <div class="content" layout="row" fusePerfectScrollbar>

        <mat-tab-group dynamicHeight>

            <mat-tab label="Все ({{total_all}})" *ngIf="columns_client_all.length > 0">

                <!-- WIDGET GROUP -->
                <div class="widget-group grey-100-bg" fxLayout="row wrap" fxFlex="100" *fuseIfOnDom
                     [@animateStagger]="{value:'50'}">
                     <!-- WIDGET 11 -->
                     <fuse-widget [@animate]="{value:'*',params:{y:'100%'}}" class="widget" fxLayout="row"
                        fxFlex="100">
                        <!-- Front -->
                        <div class="fuse-widget-front mat-white-bg mat-elevation-z2" *ngIf="rows">

                            <ngx-datatable
                                class="material"
                                [rows]="rows"
                                [columns]="columns_client_all"
                                [loadingIndicator]="loadingIndicator"
                                [columnMode]="'force'"
                                [headerHeight]="48"
                                [footerHeight]="56"
                                [rowHeight]="'auto'"
                                [scrollbarH]="true"
                                [reorderable]="reorderable"
                                [limit]="10"
                                (activate)="onActivate($event)"
                                [selectionType]="'single'"
                                (select)='onSelect($event)'
                                >
                            </ngx-datatable>
                        </div>
                        <!-- / Front -->
                    </fuse-widget>
                    <!-- / WIDGET 11 -->
                </div>
                <!-- / WIDGET GROUP -->
            </mat-tab>
            <mat-tab label="Мои ({{total_my}})" *ngIf="columns_client_my.length > 0">
                <!-- WIDGET GROUP -->
                <div class="widget-group grey-100-bg" fxLayout="row wrap" fxFlex="100" *fuseIfOnDom
                     [@animateStagger]="{value:'50'}">
                     <!-- WIDGET 11 -->
                     <fuse-widget [@animate]="{value:'*',params:{y:'100%'}}" class="widget" fxLayout="row"
                        fxFlex="100">
                        <!-- Front -->
                        <div class="fuse-widget-front mat-white-bg mat-elevation-z2" *ngIf="rows_my">

                            <ngx-datatable
                                class="material"
                                [rows]="rows_my"
                                [columns]="columns_client_my"
                                [loadingIndicator]="loadingIndicator"
                                [columnMode]="'force'"
                                [headerHeight]="48"
                                [footerHeight]="56"
                                [rowHeight]="'auto'"
                                [scrollbarH]="true"
                                [reorderable]="reorderable"
                                [limit]="10"
                                [selectionType]="'single'"
                                (activate)="onActivate($event)"
                                >
                            </ngx-datatable>
                        </div>
                        <!-- / Front -->
                    </fuse-widget>
                    <!-- / WIDGET 11 -->
                </div>
                <!-- / WIDGET GROUP -->
            </mat-tab>
            
            <mat-tab label="Объявления" *ngIf="rows_data.length > 0">
                <!-- WIDGET GROUP -->
                <div class="widget-group grey-100-bg" fxLayout="row wrap" fxFlex="100" *fuseIfOnDom
                     [@animateStagger]="{value:'50'}">
                     <!-- WIDGET 11 -->
                     <fuse-widget [@animate]="{value:'*',params:{y:'100%'}}" class="widget" fxLayout="row"
                        fxFlex="100">
                        <!-- Front -->
                        <div class="fuse-widget-front mat-white-bg mat-elevation-z2" *ngIf="rows_my">

                            <ngx-datatable
                                class="material"
                                [rows]="rows_data"
                                [columns]="data_columns"
                                [loadingIndicator]="loadingIndicator"
                                [columnMode]="'force'"
                                [headerHeight]="48"
                                [footerHeight]="56"
                                [rowHeight]="'auto'"
                                [scrollbarH]="true"
                                [reorderable]="reorderable"
                                [limit]="10"
                                [selectionType]="'single'"
                                (activate)="onActivate($event)"
                                >
                            </ngx-datatable>
                        </div>
                        <!-- / Front -->
                    </fuse-widget>
                    <!-- / WIDGET 11 -->
                </div>
                <!-- / WIDGET GROUP -->
            </mat-tab>
            

        </mat-tab-group>
        <button mat-button (click)="refreash()" color="accent" matTooltip="Обновить таблицу">Обновить</button>

    </div>


</div>


